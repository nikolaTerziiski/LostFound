{% extends "base.html" %}
{% block title %}Карта с обяви{% endblock %}

{% block content %}
<div class="container py-3">
  <h2 class="mb-3">Карта с обяви</h2>
  <div id="map-page" style="height: 520px; border-radius: 12px;" class="mb-4"></div>

  <h3 class="mt-4 mb-3">Най-нови обяви</h3>
  <div class="row g-3">
    {% for l in listings %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card h-100">
          {% if l.cover_url %}
            <img src="{{ l.cover_url }}" class="card-img-top" alt="{{ l.title|e }}">
          {% endif %}
          <div class="card-body d-flex flex-column">
            <h5 class="card-title mb-1">{{ l.title }}</h5>
            <div class="mb-2">
              {% if l.status %}<span class="badge bg-secondary">{{ l.status.value if l.status else l.status }}</span>{% endif %}
              {% if l.category %}<span class="badge bg-light text-dark">{{ l.category.name }}</span>{% endif %}
            </div>
            {% if l.location_name %}<p class="card-text text-muted mb-2">{{ l.location_name }}</p>{% endif %}
            <a class="mt-auto btn btn-sm btn-primary" href="{{ url_for('listings.detail', listing_id=l.id) }}">Детайли</a>
          </div>
        </div>
      </div>
    {% else %}
      <p class="text-muted">Няма обяви.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/map-page.js') }}"></script>

{% endblock %}
